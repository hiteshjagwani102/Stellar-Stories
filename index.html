<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Stellar Stories</title>

<!-- P5.js for the game -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/addons/p5.sound.min.js"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;600;700&display=swap');

:root{
  --light-bg: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  --dark-bg: radial-gradient(ellipse at bottom, #1b2735 0%, #090a0f 100%);
  --light-text:#2c3e50;
  --dark-text:#ecf0f1;
  --accent-light:#e74c3c;
  --accent-dark:#3498db;
  --card-light: rgba(255,255,255,0.95);
  --card-dark: rgba(20,25,45,0.95);
  --glow-color: #00d4ff;
  --secondary-glow: #ff6b6b;
}

* { box-sizing: border-box; }

body{
  margin:0;
  font-family:'Exo 2', sans-serif;
  background:var(--dark-bg);
  color:var(--dark-text);
  transition:all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
  overflow-x:hidden;
  position:relative;
  line-height:1.6;
}

body.light{ 
  background:var(--light-bg); 
  color:var(--light-text); 
}

/* FLOATING PARTICLES */
.particles {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 1;
}

.particle {
  position: absolute;
  background: radial-gradient(circle, var(--glow-color), transparent);
  border-radius: 50%;
  animation: float 15s infinite ease-in-out;
  opacity: 0.6;
}

@keyframes float {
  0%, 100% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
  10% { opacity: 1; }
  90% { opacity: 1; }
  100% { transform: translateY(-10vh) rotate(360deg); opacity: 0; }
}

/* ENHANCED STARS/CLOUDS */
.stars{ 
  display:block; 
  position:fixed; 
  width:100%; 
  height:100%; 
  background:transparent; 
  pointer-events:none; 
  z-index:0; 
  opacity: 0.7;
}
body.light .stars{ display:none; }

.stars::before{
  content:''; 
  position:absolute; 
  width:200%; 
  height:200%;
  background-image: 
    radial-gradient(2px 2px at 20px 30px, #eee, transparent),
    radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.8), transparent),
    radial-gradient(1px 1px at 90px 40px, #fff, transparent),
    radial-gradient(1px 1px at 130px 80px, rgba(255,255,255,0.6), transparent),
    radial-gradient(2px 2px at 160px 30px, #ddd, transparent);
  background-repeat: repeat;
  background-size: 200px 100px;
  animation:moveStars 120s linear infinite, twinkle 3s ease-in-out infinite alternate;
}

@keyframes moveStars{ 
  from{transform:translateY(0)} 
  to{transform:translateY(-50%)} 
}

@keyframes twinkle {
  0% { opacity: 0.7; }
  100% { opacity: 1; }
}

.clouds{ 
  display:none; 
  position:fixed; 
  width:100%; 
  height:100%; 
  pointer-events:none; 
  z-index:0;
  background: 
    radial-gradient(ellipse at center, rgba(255,255,255,0.1) 0%, transparent 50%),
    radial-gradient(ellipse at 20% 50%, rgba(255,255,255,0.05) 0%, transparent 50%),
    radial-gradient(ellipse at 80% 50%, rgba(255,255,255,0.08) 0%, transparent 50%);
  animation:moveClouds 180s linear infinite;
}

body.light .clouds{ display:block; }

@keyframes moveClouds{ 
  from{background-position: 0 0, -200px 0, 400px 0} 
  to{background-position: 1000px 0, 800px 0, 1400px 0} 
}

/* HEADER WITH GLASSMORPHISM */
header{ 
  text-align:center; 
  padding:60px 20px; 
  position:relative; 
  background: rgba(255,255,255,0.05);
  backdrop-filter: blur(10px);
  border-bottom: 1px solid rgba(255,255,255,0.1);
  margin-bottom: 0;
  z-index: 10;
}

body.light header {
  background: rgba(255,255,255,0.25);
  backdrop-filter: blur(15px);
  border-bottom: 1px solid rgba(255,255,255,0.3);
}

header h1{ 
  margin:0; 
  font-family: 'Orbitron', monospace;
  font-size: clamp(2.5rem, 5vw, 4rem);
  font-weight: 900;
  background: linear-gradient(45deg, var(--glow-color), var(--secondary-glow));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  animation: glow-pulse 3s ease-in-out infinite alternate;
  text-shadow: 0 0 30px rgba(0,212,255,0.5);
  margin-bottom: 20px;
}

@keyframes glow-pulse {
  0% { 
    filter: brightness(1) drop-shadow(0 0 10px var(--glow-color)); 
  }
  100% { 
    filter: brightness(1.2) drop-shadow(0 0 20px var(--glow-color)); 
  }
}

header p{ 
  margin:10px auto; 
  font-size: 1.2rem;
  max-width: 600px;
  opacity: 0.9;
  animation: fadeInUp 1s ease-out 0.5s both;
}

@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(30px); }
  to { opacity: 0.9; transform: translateY(0); }
}

.theme-toggle{ 
  position:absolute; 
  top:20px; 
  right:20px; 
  font-size:2rem; 
  background:rgba(255,255,255,0.1); 
  border:2px solid rgba(255,255,255,0.2);
  color: var(--dark-text);
  border-radius: 50%;
  width: 60px;
  height: 60px;
  cursor:pointer; 
  transition: all 0.3s ease;
  backdrop-filter: blur(10px);
}

.theme-toggle:hover {
  background: rgba(255,255,255,0.2);
  transform: rotate(180deg) scale(1.1);
  box-shadow: 0 0 20px var(--glow-color);
}

body.light .theme-toggle {
  color: var(--light-text);
  background: rgba(0,0,0,0.1);
  border-color: rgba(0,0,0,0.2);
}

/* ENHANCED NAVIGATION */
nav{ 
  display:flex; 
  justify-content:center; 
  padding:0; 
  background: rgba(0,0,0,0.3);
  backdrop-filter: blur(15px);
  border-top: 1px solid rgba(255,255,255,0.1);
  border-bottom: 1px solid rgba(255,255,255,0.1);
  position: sticky;
  top: 0;
  z-index: 100;
  animation: slideInDown 0.8s ease-out;
}

@keyframes slideInDown {
  from { transform: translateY(-100%); }
  to { transform: translateY(0); }
}

nav a{ 
  color:var(--accent-dark); 
  margin:0; 
  padding: 20px 30px;
  text-decoration:none; 
  font-weight: 600;
  position: relative;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  text-transform: uppercase;
  letter-spacing: 1px;
  font-size: 0.95rem;
}

nav a::before {
  content: '';
  position: absolute;
  bottom: 0;
  left: 50%;
  width: 0;
  height: 3px;
  background: linear-gradient(90deg, var(--glow-color), var(--secondary-glow));
  transition: all 0.3s ease;
  transform: translateX(-50%);
}

nav a:hover {
  color: #fff;
  background: rgba(255,255,255,0.05);
  text-shadow: 0 0 10px var(--glow-color);
}

nav a:hover::before {
  width: 80%;
}

body.light nav { 
  background: rgba(255,255,255,0.4); 
}
body.light nav a{ 
  color:var(--accent-light); 
}

/* ENHANCED SECTIONS */
section{ 
  max-width:1200px; 
  margin: 80px auto; 
  padding:60px 30px; 
  text-align:center; 
  background: var(--card-dark);
  border-radius: 20px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.3);
  backdrop-filter: blur(15px);
  border: 1px solid rgba(255,255,255,0.1);
  position: relative;
  overflow: hidden;
  animation: fadeInScale 0.8s ease-out;
  z-index: 2;
}

@keyframes fadeInScale {
  from { opacity: 0; transform: scale(0.9) translateY(30px); }
  to { opacity: 1; transform: scale(1) translateY(0); }
}

section::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle, rgba(0,212,255,0.03) 0%, transparent 70%);
  animation: rotate 20s linear infinite;
  z-index: -1;
}

@keyframes rotate {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

body.light section {
  background: var(--card-light);
  box-shadow: 0 20px 60px rgba(0,0,0,0.1);
  border-color: rgba(0,0,0,0.1);
}

body.light section::before {
  background: radial-gradient(circle, rgba(231,76,60,0.05) 0%, transparent 70%);
}

h2{ 
  margin-bottom:30px; 
  font-family: 'Orbitron', monospace;
  font-size: clamp(1.8rem, 4vw, 2.5rem);
  font-weight: 700;
  color: var(--glow-color);
  text-transform: uppercase;
  letter-spacing: 2px;
  position: relative;
  padding-bottom: 20px;
}

h2::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 50%;
  width: 100px;
  height: 3px;
  background: linear-gradient(90deg, var(--glow-color), var(--secondary-glow));
  transform: translateX(-50%);
  border-radius: 2px;
}

body.light h2 {
  color: var(--accent-light);
}

/* ENHANCED VIDEO PLAYER */
.video-wrapper{
  position: relative;
  width: 100%;
  max-width: 900px;
  margin: 40px auto;
  background: #000;
  border-radius: 20px;
  overflow: hidden;
  aspect-ratio: 16/9;
  box-shadow: 0 25px 80px rgba(0,0,0,0.4);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.video-wrapper:hover {
  transform: scale(1.02);
  box-shadow: 0 30px 100px rgba(0,212,255,0.2);
}

video{
  width:100%;
  height:100%;
  display:block;
  object-fit:contain;
  background:#000;
}

.video-controls{
  position:absolute;
  bottom:0;
  left:0;
  right:0;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:15px 20px;
  color:#fff;
  font-size:14px;
  background: linear-gradient(to top, rgba(0,0,0,0.8), rgba(0,0,0,0.4) 50%, transparent);
  transition:opacity 0.3s ease;
  backdrop-filter: blur(5px);
}

.video-controls button{
  background: rgba(255,255,255,0.15);
  border:none;
  color:#fff;
  padding:10px 15px;
  border-radius:8px;
  cursor:pointer;
  transition: all 0.3s ease;
  backdrop-filter: blur(10px);
  font-size: 16px;
}

.video-controls button:hover {
  background: rgba(255,255,255,0.25);
  transform: scale(1.05);
}

.video-controls input[type="range"]{ 
  flex:1; 
  margin:0 15px; 
  height: 6px;
  background: rgba(255,255,255,0.3);
  border-radius: 3px;
  outline: none;
}

/* ENHANCED ACTORS SECTION */
.dependence{ 
  display:grid; 
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap:30px; 
  margin-top:50px; 
}

.actor{ 
  padding:30px; 
  background: rgba(255,255,255,0.05); 
  border-radius:20px; 
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
  cursor:pointer; 
  position: relative;
  overflow: hidden;
  border: 1px solid rgba(255,255,255,0.1);
  backdrop-filter: blur(10px);
}

.actor::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
  transition: left 0.5s ease;
}

.actor:hover::before {
  left: 100%;
}

.actor:hover{ 
  transform:translateY(-10px) scale(1.02); 
  background: rgba(255,255,255,0.1); 
  box-shadow: 0 25px 80px rgba(0,212,255,0.3);
  border-color: var(--glow-color);
}

body.light .actor{ 
  background: rgba(255,255,255,0.7); 
  border-color: rgba(0,0,0,0.1);
}

body.light .actor:hover {
  background: rgba(255,255,255,0.9);
  box-shadow: 0 25px 80px rgba(231,76,60,0.2);
  border-color: var(--accent-light);
}

.actor h3{ 
  margin-bottom:15px; 
  font-family: 'Orbitron', monospace;
  color: var(--glow-color);
  font-size: 1.3rem;
  font-weight: 600;
}

body.light .actor h3 {
  color: var(--accent-light);
}

.actor p {
  font-size: 1rem;
  line-height: 1.6;
  opacity: 0.9;
}

/* ENHANCED COMIC OVERLAY */
.comic-overlay{
  display:none;
  position:fixed; 
  top:0; 
  left:0;
  width:100%; 
  height:100%;
  background: rgba(0,0,0,0.95);
  z-index:9999;
  justify-content:center; 
  align-items:center; 
  flex-direction:column;
  backdrop-filter: blur(20px);
  animation: fadeIn 0.3s ease-out;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.comic-container{
  position:relative;
  width:90vw;
  height:90vh;
  max-width:100%;
  max-height:100%;
  overflow:hidden;
  border-radius:20px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  display:flex;
  align-items:center;
  justify-content:center;
  box-shadow: 0 50px 150px rgba(0,0,0,0.8);
  border: 2px solid rgba(255,255,255,0.2);
  animation: slideInScale 0.4s ease-out;
}

@keyframes slideInScale {
  from { 
    opacity: 0; 
    transform: scale(0.8) translateY(50px); 
  }
  to { 
    opacity: 1; 
    transform: scale(1) translateY(0); 
  }
}

.comic-slides{
  display:flex;
  transition:transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  will-change:transform;
  width:100%;
  height:100%;
}

.comic-slide{
  min-width:100%;
  min-height:100%;
  box-sizing:border-box;
  display:flex;
  align-items:center;
  justify-content:center;
}

.comic-slide img{
  width:100%;
  height:100%;
  object-fit:contain;
  border-radius:15px;
  transition: transform 0.3s ease;
}

.comic-counter{ 
  position:absolute; 
  top:20px; 
  right:25px; 
  color:#fff; 
  background: rgba(0,0,0,0.6); 
  padding:10px 20px; 
  border-radius:25px; 
  font-size:16px; 
  z-index:20;
  font-weight: 600;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255,255,255,0.2);
}

.close-comic{ 
  position:absolute; 
  top:20px; 
  left:25px; 
  background: rgba(255,255,255,0.15); 
  color:#fff; 
  border:none; 
  padding:12px 16px; 
  border-radius:50%; 
  cursor:pointer; 
  z-index:20;
  font-size: 18px;
  width: 50px;
  height: 50px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
  backdrop-filter: blur(10px);
}

.close-comic:hover {
  background: rgba(255,255,255,0.25);
  transform: scale(1.1);
}

.comic-nav{ 
  margin-top:25px; 
  display:flex; 
  justify-content:space-between; 
  width:180px;
  gap: 20px;
}

.comic-nav button{ 
  background: rgba(255,255,255,0.15); 
  border:none; 
  color:#fff; 
  padding:12px 20px; 
  border-radius:25px; 
  cursor:pointer;
  font-size: 16px;
  font-weight: 600;
  transition: all 0.3s ease;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255,255,255,0.2);
  flex: 1;
}

.comic-nav button:hover {
  background: rgba(255,255,255,0.25);
  transform: translateY(-2px);
}

/* ENHANCED GAME CONTAINER */
#game-container {
  width: 100%;
  max-width: 900px;
  aspect-ratio: 3/2;
  border: 3px solid var(--glow-color);
  border-radius: 20px;
  overflow: hidden;
  margin: 50px auto;
  position: relative;
  box-shadow: 
    0 0 50px rgba(0,212,255,0.4),
    inset 0 0 50px rgba(0,212,255,0.1);
  transition: all 0.3s ease;
}

#game-container:hover {
  box-shadow: 
    0 0 80px rgba(0,212,255,0.6),
    inset 0 0 80px rgba(0,212,255,0.15);
}

canvas {
  width: 100% !important;
  height: 100% !important;
  display: block;
  border-radius: 17px;
}

/* INTRO SECTION ENHANCEMENTS */
#intro p {
  font-size: 1.1rem;
  line-height: 1.8;
  margin-bottom: 25px;
  opacity: 0.9;
}

#intro p:first-of-type {
  font-size: 1.2rem;
  font-weight: 400;
  color: var(--glow-color);
  margin-bottom: 35px;
}

body.light #intro p:first-of-type {
  color: var(--accent-light);
}

/* RESPONSIVE DESIGN */
@media (max-width: 768px) {
  header {
    padding: 40px 15px;
  }
  
  header h1 {
    font-size: 2.5rem;
  }
  
  nav a {
    padding: 15px 20px;
    font-size: 0.9rem;
  }
  
  section {
    margin: 40px 15px;
    padding: 40px 20px;
  }
  
  .dependence {
    grid-template-columns: 1fr;
    gap: 20px;
  }
  
  .theme-toggle {
    width: 50px;
    height: 50px;
    font-size: 1.5rem;
  }
  
  .comic-container {
    width: 95vw;
    height: 85vh;
  }
  
  .comic-nav {
    width: 140px;
  }
}

/* LOADING ANIMATION */
.section-loading {
  opacity: 0;
  animation: sectionFadeIn 0.8s ease-out 0.2s forwards;
}

@keyframes sectionFadeIn {
  from { 
    opacity: 0; 
    transform: translateY(30px); 
  }
  to { 
    opacity: 1; 
    transform: translateY(0); 
  }
}
</style>
</head>

<body>
<!-- Floating Particles -->
<div class="particles" id="particles"></div>

<div class="stars"></div>
<div class="clouds"></div>

<header>
  <h1>Interactive Stellar Stories</h1>
  <p>Explore the magnificent cosmos and understand space weather phenomena through immersive storytelling</p>
  <button class="theme-toggle" id="themeToggle">🌙</button>
</header>

<nav>
  <a href="#intro">Overview</a>
  <a href="#story">Interactive Story</a>
  <a href="#dependence">Impact Analysis</a>
  <a href="#game">Space Game</a>
</nav>

<section id="intro" class="section-loading">
  <h2>Welcome to the World of Space Weather</h2>
  <p>Discover the invisible forces that shape our cosmic environment and directly impact life on Earth through dynamic solar phenomena.</p>
  
  <p>Solar weather encompasses the complex conditions in space driven by our Sun's magnetic activity. This includes solar flares, sunspots, coronal mass ejections, and the continuous solar wind. These powerful events release tremendous amounts of energy and charged particles into the solar system, creating a dynamic and ever-changing space environment.</p>
  
  <p><strong>SOLAR FLARE:</strong> A solar flare represents one of the most spectacular displays of our Sun's power - a sudden, intense burst of electromagnetic radiation from the solar surface. These events can release energy equivalent to billions of nuclear bombs, sending waves of radiation across the solar system that can dramatically affect satellite operations, radio communications, and even power grids here on Earth.</p>
</section>

<section id="story" class="section-loading">
  <h2>Interactive Story Experience</h2>
  <p>Immerse yourself in our visual narrative exploring the journey of solar flares from the Sun to Earth.</p>

  <div class="video-wrapper">
    <video id="spaceVideo" preload="metadata" playsinline>
      <source src="animation1.mp4" type="video/mp4">
      Your browser does not support HTML5 video.
    </video>

    <div class="video-controls" id="videoControls">
      <button id="playPause">▶</button>
      <input id="seekBar" type="range" min="0" max="100" step="0.1" value="0">
      <span id="timeDisplay">0:00 / 0:00</span>
    </div>
  </div>
</section>

<section id="dependence" class="section-loading">
  <h2>Space Weather Impact Analysis</h2>
  <p>Explore how solar phenomena affect different aspects of modern society through interactive case studies.</p>
  
  <div class="dependence">
    <div class="actor" id="farmers">
      <h3>🌾 Agricultural Systems</h3>
      <p>Modern precision agriculture relies heavily on GPS technology for automated tractors, drone navigation, and irrigation timing. Solar storms can disrupt these satellite signals, causing navigation errors that affect planting patterns, harvesting efficiency, and crop monitoring systems.</p>
    </div>
    
    <div class="actor" id="pilots">
      <h3>✈️ Aviation Industry</h3>
      <p>Commercial aviation faces significant challenges during solar events. High-altitude polar flights experience increased radiation exposure, potentially requiring route changes or altitude adjustments. Communication systems can also be disrupted, affecting air traffic control coordination.</p>
    </div>
    
    <div class="actor" id="astronauts">
      <h3>🚀 Space Exploration</h3>
      <p>Astronauts aboard the International Space Station and future Mars missions face direct exposure to dangerous solar radiation. During major solar storms, crew members must take shelter in specially shielded areas to avoid potentially life-threatening radiation doses.</p>
    </div>
    
    <div class="actor" id="powergrid">
      <h3>⚡ Power Infrastructure</h3>
      <p>Geomagnetic storms induced by solar activity can create electrical currents in power transmission lines, potentially overloading transformers and causing widespread blackouts. The 1989 Quebec blackout affected 6 million people due to such geomagnetic disturbances.</p>
    </div>
    
    <div class="actor" id="generalpublic">
      <h3>📱 Digital Society</h3>
      <p>Our interconnected world depends on satellite communications, GPS navigation, and internet infrastructure. Solar storms can disrupt mobile networks, internet services, banking systems, and emergency communication networks, affecting billions of people globally.</p>
    </div>
  </div>
</section>

<section id="game" class="section-loading">
  <h2>Solar Flare Defense Mission</h2>
  <p>Take control of Earth's magnetic field and protect our planet from incoming solar radiation. Collect beneficial solar energy while deflecting dangerous flares to maintain our technological civilization.</p>
  
  <p><strong>Mission Objective:</strong> Successfully capture 30 light solar flares 🔥 to harness their energy while avoiding 5 intense solar flares ⚡ that could damage our infrastructure. Master the delicate balance between harnessing solar power and protecting Earth's technology.</p>
  
  <div id="game-container"></div>
</section>

<!-- COMIC OVERLAY -->
<div class="comic-overlay" id="comicOverlay" aria-hidden="true">
  <div class="comic-container" role="dialog" aria-modal="true">
    <button class="close-comic" id="closeComicBtn" aria-label="Close">✖</button>
    <div class="comic-counter" id="comicCounter">1 / 4</div>
    <div class="comic-slides" id="comicSlides"></div>
  </div>

  <div class="comic-nav" id="comicNav">
    <button id="prevSlide">⟨ Previous</button>
    <button id="nextSlide">Next ⟩</button>
  </div>
</div>

<script>
/* ENHANCED THEME TOGGLE */
const themeToggle=document.getElementById('themeToggle');
themeToggle.addEventListener('click',()=>{
  document.body.classList.toggle('light'); 
  themeToggle.textContent=document.body.classList.contains('light')?'
